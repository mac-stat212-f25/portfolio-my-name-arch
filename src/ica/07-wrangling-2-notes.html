<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>7 Adv Data wrangling P2 ‚Äì COMP/STAT212 Portfolio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../src/appx/appx-sample1.html" rel="next">
<link href="../../src/ica/04-adv-maps-1-notes.html" rel="prev">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-463f7e572b85bff0cfe833e89a202fa4.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-2b27489b1280a247593da265a4955406.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script><style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="../../style/custom.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/ica/ica-sample1.html">In-Class Activities</a></li><li class="breadcrumb-item"><a href="../../src/ica/07-wrangling-2-notes.html"><span class="chapter-title">7 Adv Data wrangling P2</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../assets/sidebar-logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Your Name Here</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Prof Viz</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/pv/pv-01.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Professional Viz Sample</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">TidyTuesday</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/2025-07-08.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">TidyTuesday Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/2025-07-15.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">TT1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/hw04-tt.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Homework 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/tt/hw05-tt.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Homework 05</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">In-Class Activities</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/ica-sample1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ICA Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/ica-sample2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">ICA Sample 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/cleaning.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Cleaning SFO Weather Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/03-adv-ggplot-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">3 Advanced Data Viz</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/10-base-r-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10 Base R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/09-functions-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">9 Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/06-wrangling-1-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">6 Adv Data wrangling P1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/04-adv-maps-1-notes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">4 Adv Spatial Viz P1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/ica/07-wrangling-2-notes.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">7 Adv Data wrangling P2</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/appx/appx-sample1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix Sample 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../src/appx/appx-sample2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Appendix Sample 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../mm/mm.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Mind Maps</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">üß© Learning Goals</a></li>
  <li><a href="#helpful-cheatsheets" id="toc-helpful-cheatsheets" class="nav-link" data-scroll-target="#helpful-cheatsheets">Helpful Cheatsheets</a></li>
  <li><a href="#motivation-30-years-of-american-anxieties" id="toc-motivation-30-years-of-american-anxieties" class="nav-link" data-scroll-target="#motivation-30-years-of-american-anxieties">Motivation: 30 Years of American Anxieties</a></li>
  <li><a href="#strings" id="toc-strings" class="nav-link" data-scroll-target="#strings">Strings</a></li>
  <li><a href="#creating-strings" id="toc-creating-strings" class="nav-link" data-scroll-target="#creating-strings">Creating strings</a></li>
  <li><a href="#extracting-information-from-strings" id="toc-extracting-information-from-strings" class="nav-link" data-scroll-target="#extracting-information-from-strings">Extracting information from strings</a></li>
  <li><a href="#finding-patterns-in-strings-with-regular-expressions" id="toc-finding-patterns-in-strings-with-regular-expressions" class="nav-link" data-scroll-target="#finding-patterns-in-strings-with-regular-expressions">Finding patterns in strings with regular expressions</a></li>
  <li><a href="#exploring-stringr-functions" id="toc-exploring-stringr-functions" class="nav-link" data-scroll-target="#exploring-stringr-functions">Exploring <code>stringr</code> functions</a></li>
  <li><a href="#done" id="toc-done" class="nav-link" data-scroll-target="#done">Done!</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../src/ica/ica-sample1.html">In-Class Activities</a></li><li class="breadcrumb-item"><a href="../../src/ica/07-wrangling-2-notes.html"><span class="chapter-title">7 Adv Data wrangling P2</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">7 Adv Data wrangling P2</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><section id="learning-goals" class="level2"><h2 class="anchored" data-anchor-id="learning-goals">üß© Learning Goals</h2>
<p>By the end of this lesson, you should be able to:</p>
<ul>
<li>Manipulate and explore strings using the <code>stringr</code> package</li>
<li>Construct regular expressions to find patterns in strings</li>
</ul></section><section id="helpful-cheatsheets" class="level2"><h2 class="anchored" data-anchor-id="helpful-cheatsheets">Helpful Cheatsheets</h2>
<p>The <code>stringr</code> cheatsheet (<a href="https://rstudio.github.io/cheatsheets/html/strings.html">HTML</a>, <a href="https://rstudio.github.io/cheatsheets/strings.pdf">PDF</a>) will be useful to have open and reference.</p>
</section><section id="motivation-30-years-of-american-anxieties" class="level2"><h2 class="anchored" data-anchor-id="motivation-30-years-of-american-anxieties">Motivation: 30 Years of American Anxieties</h2>
<p>In 2018 the data journalism organization <a href="https://pudding.cool/">The Pudding</a> featured a story called <a href="https://pudding.cool/2018/11/dearabby/">30 Years of American Anxieties</a> about themes in 30 years of posts to the Dear Abby column (an American advice column).</p>
<p>One way to understand themes in text data is to conduct a <strong>qualitative analysis</strong>, a methodology in which multiple readers read through instances of text several times to reach a consensus about themes.</p>
<p>Another way to understand themes in text data is <strong>computational text analysis</strong>.</p>
<ul>
<li>This is what we will explore today.</li>
</ul>
<p>Both qualitative analysis and computational tools can be used in tandem. Often, using computational tools can help focus a close reading of select texts, which parallels the spirit of a qualitative analysis.</p>
<p>To prepare ourselves for a computational analysis, let‚Äôs learn about strings.</p>
</section><section id="strings" class="level2"><h2 class="anchored" data-anchor-id="strings">Strings</h2>
<p>Strings are objects of the <code>character</code> class (abbreviated as <code>&lt;chr&gt;</code> in tibbles).</p>
<p>When you print out strings, they display with double quotes:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>some_string <span class="ot">&lt;-</span> <span class="st">"banana"</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>some_string</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "banana"</code></pre>
</div>
</div>
<p>Working with strings generally will involve the use of <strong>regular expressions</strong>, a tool for finding patterns in strings.</p>
<p>Regular expressions (regex, for short) look like the following:</p>
<pre><code>"^the" (Strings that start with "the")
"end$" (Strings that end with "end")</code></pre>
<p>Before getting to regular expressions, let‚Äôs go over some fundamentals about working with strings. The <code>stringr</code> package (available within <code>tidyverse</code>) is great for working with strings.</p>
</section><section id="creating-strings" class="level2"><h2 class="anchored" data-anchor-id="creating-strings">Creating strings</h2>
<p>Creating strings by hand is useful for testing out regular expressions.</p>
<p>To create a string, type any text in either double quotes (<code>"</code>) or single quotes <code>'</code>. Using double or single quotes doesn‚Äôt matter unless your string itself has single or double quotes.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>string1 <span class="ot">&lt;-</span> <span class="st">"This is a string"</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>string2 <span class="ot">&lt;-</span> <span class="st">'If I want to include a "quote" inside a string, I use single quotes'</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>string3 <span class="ot">&lt;-</span> <span class="fu">c</span>(string1, string2) <span class="co"># string / character vector (of greater than length 1)</span></span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="fu">class</span>(string1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">class</span>(string2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">class</span>(string3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">length</span>(string1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">length</span>(string2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">length</span>(string3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>We can view these strings ‚Äúnaturally‚Äù (without the opening and closing quotes) with <code>str_view()</code>:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">str_view</span>(string1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ This is a string</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">str_view</span>(string2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ If I want to include a "quote" inside a string, I use single quotes</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">str_view</span>(string3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ This is a string
[2] ‚îÇ If I want to include a "quote" inside a string, I use single quotes</code></pre>
</div>
</div>
<p><strong>Exercise:</strong> Create the string <code>It's Thursday</code>. What happens if you put the string inside single quotes? Double quotes?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># Your code</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>string1 <span class="ot">&lt;-</span> <span class="st">"It's Thursday"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>It doesn‚Äôt work with single quotes because it thinks it ends the string after It. Because <code>"</code> and <code>'</code> are special characters in the creation of strings, R offers another way to put them inside a string. We can <strong>escape</strong> these special characters by putting a <code>\</code> in front of them:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>string1 <span class="ot">&lt;-</span> <span class="st">"This is a string with </span><span class="sc">\"</span><span class="st">double quotes</span><span class="sc">\"</span><span class="st">"</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>string2 <span class="ot">&lt;-</span> <span class="st">"This is a string with </span><span class="sc">\'</span><span class="st">single quotes</span><span class="sc">\'</span><span class="st">"</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="fu">str_view</span>(string1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ This is a string with "double quotes"</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">str_view</span>(string2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ This is a string with 'single quotes'</code></pre>
</div>
</div>
<p>Given that <code>\</code> is a special character, how can we put the <code>\</code> character in strings? We have to escape it with <code>\\</code>.</p>
<p><strong>Exercise:</strong> Create the string <code>C:\Users</code>. What happens when you don‚Äôt escape the <code>\</code>?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Your code</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co">#string1 &lt;- 'C:\Users'</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>string2 <span class="ot">&lt;-</span> <span class="st">'C:</span><span class="sc">\\</span><span class="st">Users'</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="fu">str_view</span>(string2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ C:\Users</code></pre>
</div>
</div>
<p>If you fail to escape, you get an error Other special characters include:</p>
<ul>
<li>
<code>\t</code> (Creates a tab)</li>
<li>
<code>\n</code> (Creates a newline)</li>
</ul>
<p>Both can be useful in plots to more neatly arrange text.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>string1 <span class="ot">&lt;-</span> <span class="st">"Record temp:</span><span class="sc">\t</span><span class="st">102"</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>string2 <span class="ot">&lt;-</span> <span class="st">"Record temp:</span><span class="sc">\n</span><span class="st">102"</span></span>
<span id="cb29-3"><a href="#cb29-3"></a></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="fu">str_view</span>(string1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ Record temp:{\t}102</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">str_view</span>(string2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ Record temp:
    ‚îÇ 102</code></pre>
</div>
</div>
<p>Can we get <code>str_view()</code> to show the tab instead of <code>{\t}</code>? We can use the <code>html</code> argument to have the string displayed as if on a webpage:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">str_view</span>(string1, <span class="at">html =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Often we will want to create new strings within data frames. We can use <code>str_c()</code> or <code>str_glue()</code>, both of which are vectorized functions (meaning they take vectors as inputs and provide vectors as outputs - can be used within <code>mutate()</code>):</p>
<ul>
<li>With <code>str_c()</code> the strings to be combined are all separate arguments separated by commas.</li>
<li>With <code>str_glue()</code> the desired string is written as a template with variable names inside curly braces <code><a href="https://rdrr.io/r/base/Paren.html">{}</a></code>.</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-2"><a href="#cb34-2"></a>    <span class="at">first_name =</span> <span class="fu">c</span>(<span class="st">"Arya"</span>, <span class="st">"Olenna"</span>, <span class="st">"Tyrion"</span>, <span class="st">"Melisandre"</span>),</span>
<span id="cb34-3"><a href="#cb34-3"></a>    <span class="at">last_name =</span> <span class="fu">c</span>(<span class="st">"Stark"</span>, <span class="st">"Tyrell"</span>, <span class="st">"Lannister"</span>, <span class="cn">NA</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a>)</span>
<span id="cb34-5"><a href="#cb34-5"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 2
  first_name last_name
  &lt;chr&gt;      &lt;chr&gt;    
1 Arya       Stark    
2 Olenna     Tyrell   
3 Tyrion     Lannister
4 Melisandre &lt;NA&gt;     </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>    <span class="fu">mutate</span>(</span>
<span id="cb36-3"><a href="#cb36-3"></a>        <span class="at">full_name1 =</span> <span class="fu">str_c</span>(first_name, <span class="st">" "</span>, last_name),</span>
<span id="cb36-4"><a href="#cb36-4"></a>        <span class="at">full_name2 =</span> <span class="fu">str_glue</span>(<span class="st">"{first_name} {last_name}"</span>)</span>
<span id="cb36-5"><a href="#cb36-5"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 4
  first_name last_name full_name1       full_name2      
  &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;            &lt;glue&gt;          
1 Arya       Stark     Arya Stark       Arya Stark      
2 Olenna     Tyrell    Olenna Tyrell    Olenna Tyrell   
3 Tyrion     Lannister Tyrion Lannister Tyrion Lannister
4 Melisandre &lt;NA&gt;      &lt;NA&gt;             Melisandre NA   </code></pre>
</div>
</div>
<p><strong>Exercise:</strong> In the following data frame, create a full date string in month-day-year format using both <code>str_c()</code> and <code>str_glue()</code>.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>df_dates <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb38-2"><a href="#cb38-2"></a>    <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2001</span>, <span class="dv">2002</span>),</span>
<span id="cb38-3"><a href="#cb38-3"></a>    <span class="at">month =</span> <span class="fu">c</span>(<span class="st">"Jan"</span>, <span class="st">"Feb"</span>, <span class="st">"Mar"</span>),</span>
<span id="cb38-4"><a href="#cb38-4"></a>    <span class="at">day =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb38-5"><a href="#cb38-5"></a>)</span>
<span id="cb38-6"><a href="#cb38-6"></a></span>
<span id="cb38-7"><a href="#cb38-7"></a></span>
<span id="cb38-8"><a href="#cb38-8"></a>df_dates <span class="sc">|&gt;</span></span>
<span id="cb38-9"><a href="#cb38-9"></a>    <span class="fu">mutate</span>(</span>
<span id="cb38-10"><a href="#cb38-10"></a>        <span class="at">full_name1 =</span> <span class="fu">str_c</span>(month, <span class="st">" "</span>,day, <span class="st">" "</span>,year),</span>
<span id="cb38-11"><a href="#cb38-11"></a>        <span class="at">full_name2 =</span> <span class="fu">str_glue</span>(<span class="st">"{month} {day}{year}"</span>)</span>
<span id="cb38-12"><a href="#cb38-12"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 5
   year month   day full_name1 full_name2
  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;glue&gt;    
1  2000 Jan       3 Jan 3 2000 Jan 32000 
2  2001 Feb       4 Feb 4 2001 Feb 42001 
3  2002 Mar       5 Mar 5 2002 Mar 52002 </code></pre>
</div>
</div>
</section><section id="extracting-information-from-strings" class="level2"><h2 class="anchored" data-anchor-id="extracting-information-from-strings">Extracting information from strings</h2>
<p>The <code>str_length()</code> counts the number of characters in a string.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>comments <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb40-2"><a href="#cb40-2"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Alice"</span>, <span class="st">"Bob"</span>),</span>
<span id="cb40-3"><a href="#cb40-3"></a>    <span class="at">comment =</span> <span class="fu">c</span>(<span class="st">"The essay was well organized around the core message and had good transitions."</span>, <span class="st">"Good job!"</span>)</span>
<span id="cb40-4"><a href="#cb40-4"></a>)</span>
<span id="cb40-5"><a href="#cb40-5"></a></span>
<span id="cb40-6"><a href="#cb40-6"></a>comments <span class="sc">|&gt;</span></span>
<span id="cb40-7"><a href="#cb40-7"></a>    <span class="fu">mutate</span>(</span>
<span id="cb40-8"><a href="#cb40-8"></a>        <span class="at">comment_length =</span> <span class="fu">str_length</span>(comment)</span>
<span id="cb40-9"><a href="#cb40-9"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 √ó 3
  name  comment                                                   comment_length
  &lt;chr&gt; &lt;chr&gt;                                                              &lt;int&gt;
1 Alice The essay was well organized around the core message and‚Ä¶             78
2 Bob   Good job!                                                              9</code></pre>
</div>
</div>
<p>The <code>str_sub()</code> function gets a substring of a string. The 2nd and 3rd arguments indicate the beginning and ending position to extract.</p>
<ul>
<li>Negative positions indicate the position from the end of the word. (e.g., -3 indicates ‚Äú3rd letter from the end‚Äù)</li>
<li>Specifying a position that goes beyond the word won‚Äôt result in an error. <code>str_sub()</code> will just go as far as possible.</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Apple"</span>, <span class="st">"Banana"</span>, <span class="st">"Pear"</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "App" "Ban" "Pea"</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">end =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "ple" "ana" "ear"</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">str_sub</span>(x, <span class="at">start =</span> <span class="dv">2</span>, <span class="at">end =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "pple"  "anana" "ear"  </code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">str_sub</span>(<span class="st">"a"</span>, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">end =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "a"</code></pre>
</div>
</div>
<p><strong>Exercise:</strong> Using <code>str_sub()</code>, create a new variable with only the middle letter of each word in the data frame below. (Challenge: How would you handle words with an even number of letters?)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb50-2"><a href="#cb50-2"></a></span>
<span id="cb50-3"><a href="#cb50-3"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="at">word_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb50-5"><a href="#cb50-5"></a>  <span class="at">word =</span> <span class="fu">c</span>(<span class="st">"replace"</span>, <span class="st">"match"</span>, <span class="st">"pattern"</span>)</span>
<span id="cb50-6"><a href="#cb50-6"></a>)</span>
<span id="cb50-7"><a href="#cb50-7"></a></span>
<span id="cb50-8"><a href="#cb50-8"></a><span class="co"># Create a new variable with the middle letter</span></span>
<span id="cb50-9"><a href="#cb50-9"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10"></a>  <span class="fu">mutate</span>(</span>
<span id="cb50-11"><a href="#cb50-11"></a>    <span class="at">middle_letter =</span> <span class="fu">str_sub</span>(word,</span>
<span id="cb50-12"><a href="#cb50-12"></a>      <span class="at">start =</span> (<span class="fu">str_length</span>(word) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb50-13"><a href="#cb50-13"></a>      <span class="at">end =</span> (<span class="fu">str_length</span>(word) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb50-14"><a href="#cb50-14"></a>    )</span>
<span id="cb50-15"><a href="#cb50-15"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 3
  word_id word    middle_letter
    &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;        
1       1 replace l            
2       2 match   t            
3       3 pattern t            </code></pre>
</div>
</div>
</section><section id="finding-patterns-in-strings-with-regular-expressions" class="level2"><h2 class="anchored" data-anchor-id="finding-patterns-in-strings-with-regular-expressions">Finding patterns in strings with regular expressions</h2>
<p>Suppose that you‚Äôre exploring text data looking for places where people describe happiness. There are many ways to search. We could search for the word ‚Äúhappy‚Äù but that excludes ‚Äúhappiness‚Äù so we might search for ‚Äúhappi‚Äù.</p>
<p><strong>Regular expressions</strong> (regex) are a powerful language for describing patterns within strings.</p>
<p>. . .</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">data</span>(fruit)</span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="fu">data</span>(words)</span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="fu">data</span>(sentences)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can use <code>str_view()</code> with the <code>pattern</code> argument to see what parts of a string match the regex supplied in the <code>pattern</code> argument. (Matches are enclosed in <code>&lt;&gt;</code>.)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">str_view</span>(fruit, <span class="st">"berry"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [6] ‚îÇ bil&lt;berry&gt;
 [7] ‚îÇ black&lt;berry&gt;
[10] ‚îÇ blue&lt;berry&gt;
[11] ‚îÇ boysen&lt;berry&gt;
[19] ‚îÇ cloud&lt;berry&gt;
[21] ‚îÇ cran&lt;berry&gt;
[29] ‚îÇ elder&lt;berry&gt;
[32] ‚îÇ goji &lt;berry&gt;
[33] ‚îÇ goose&lt;berry&gt;
[38] ‚îÇ huckle&lt;berry&gt;
[50] ‚îÇ mul&lt;berry&gt;
[70] ‚îÇ rasp&lt;berry&gt;
[73] ‚îÇ salal &lt;berry&gt;
[76] ‚îÇ straw&lt;berry&gt;</code></pre>
</div>
</div>
<p><strong>Essentials of forming a regex</strong></p>
<ul>
<li>Letters and numbers in a regex are matched exactly and are called <strong>literal characters</strong>.</li>
<li>Most punctuation characters, like <code>.</code>, <code>+</code>, <code>*</code>, <code>[</code>, <code>]</code>, and <code>?</code>, have special meanings and are called <strong>metacharacters</strong>.</li>
<li>
<strong>Quantifiers</strong> come after a regex and control how many times a pattern can match:
<ul>
<li>
<code>?</code>: match the preceding pattern 0 or 1 times</li>
<li>
<code>+</code>: match the preceding pattern at least once</li>
<li>
<code>*</code>: match the preceding pattern at least 0 times (any number of times)</li>
</ul>
</li>
</ul>
<p>. . .</p>
<p><strong>Exercise:</strong> Before running the code below, predict what matches will be made. Run the code to check your guesses. Note that in all regex‚Äôs below the <code>?, +, *</code> applies to the <code>b</code> only (not the <code>a</code>).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">str_view</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"ab"</span>, <span class="st">"abb"</span>), <span class="st">"ab?"</span>)</span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="fu">str_view</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"ab"</span>, <span class="st">"abb"</span>), <span class="st">"ab+"</span>)</span>
<span id="cb55-3"><a href="#cb55-3"></a><span class="fu">str_view</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"ab"</span>, <span class="st">"abb"</span>), <span class="st">"ab*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>We can match any of a set of characters with <code>[]</code> (called a <strong>character class</strong>), e.g., <code>[abcd]</code> matches ‚Äúa‚Äù, ‚Äúb‚Äù, ‚Äúc‚Äù, or ‚Äúd‚Äù.
<ul>
<li>We can invert the match by starting with <code>^</code>: <code>[^abcd]</code> matches anything except ‚Äúa‚Äù, ‚Äúb‚Äù, ‚Äúc‚Äù, or ‚Äúd‚Äù.</li>
</ul>
</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="co"># Match words that have vowel-x-vowel</span></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="fu">str_view</span>(words, <span class="st">"[aeiou]x[aeiou]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[284] ‚îÇ &lt;exa&gt;ct
[285] ‚îÇ &lt;exa&gt;mple
[288] ‚îÇ &lt;exe&gt;rcise
[289] ‚îÇ &lt;exi&gt;st</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># Match words that have not_vowel-y-not_vowel</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="fu">str_view</span>(words, <span class="st">"[^aeiou]y[^aeiou]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[836] ‚îÇ &lt;sys&gt;tem
[901] ‚îÇ &lt;typ&gt;e</code></pre>
</div>
</div>
<p><strong>Exercise</strong> Using the <code>words</code> data, find words that have two vowels in a row followed by an ‚Äúm‚Äù.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Your code</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="fu">str_view</span>(words, <span class="st">"[aeiou][aeiou]m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[154] ‚îÇ cl&lt;aim&gt;
[714] ‚îÇ r&lt;oom&gt;
[735] ‚îÇ s&lt;eem&gt;
[844] ‚îÇ t&lt;eam&gt;</code></pre>
</div>
</div>
<ul>
<li>The <strong>alternation</strong> operator <code>|</code> can be read just like the logical operator <code>|</code> (‚ÄúOR‚Äù) to pick between one or more alternative patterns. e.g., <code>apple|banana</code> searches for ‚Äúapple‚Äù or ‚Äúbanana‚Äù.</li>
</ul>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">str_view</span>(fruit, <span class="st">"apple|melon|nut"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] ‚îÇ &lt;apple&gt;
[13] ‚îÇ canary &lt;melon&gt;
[20] ‚îÇ coco&lt;nut&gt;
[52] ‚îÇ &lt;nut&gt;
[62] ‚îÇ pine&lt;apple&gt;
[72] ‚îÇ rock &lt;melon&gt;
[80] ‚îÇ water&lt;melon&gt;</code></pre>
</div>
</div>
<p><strong>Exercise:</strong> Using the <code>fruit</code> data, find fruits that have a repeated vowel (‚Äúaa‚Äù, ‚Äúee‚Äù, ‚Äúii‚Äù, ‚Äúoo‚Äù, or ‚Äúuu‚Äù.)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="co"># Your code</span></span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="fu">str_view</span>(fruit, <span class="st">"aa|ee|ii|oo|uu"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [9] ‚îÇ bl&lt;oo&gt;d orange
[33] ‚îÇ g&lt;oo&gt;seberry
[47] ‚îÇ lych&lt;ee&gt;
[66] ‚îÇ purple mangost&lt;ee&gt;n</code></pre>
</div>
</div>
<ul>
<li>The <code>^</code> operator indicates the beginning of a string, and the <code>$</code> operator indicates the end of a string. e.g., <code>^a</code> matches strings that start with ‚Äúa‚Äù, and <code>a$</code> matches words that end with ‚Äúa‚Äù.</li>
<li>Parentheses group together parts of a regular expression that should be taken as a bundle. (Much like parentheses in arithmetic statements.)
<ul>
<li>e.g., <code>ab+</code> is a little confusing. Does it match ‚Äúab‚Äù one or more times? Or does it match ‚Äúa‚Äù first, then just ‚Äúb‚Äù one or more times? (The latter, as we saw in an earlier example.) We can be very explicit and use <code>a(b)+</code>.</li>
</ul>
</li>
</ul>
<p><strong>Exercise:</strong> Using the <code>words</code> data, find (1) words that start with ‚Äúy‚Äù and (2) words that don‚Äôt start with ‚Äúy‚Äù.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># Your code</span></span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="co"># Match words that have vowel-x-vowel</span></span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="fu">str_view</span>(words, <span class="st">"^y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[975] ‚îÇ &lt;y&gt;ear
[976] ‚îÇ &lt;y&gt;es
[977] ‚îÇ &lt;y&gt;esterday
[978] ‚îÇ &lt;y&gt;et
[979] ‚îÇ &lt;y&gt;ou
[980] ‚îÇ &lt;y&gt;oung</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># Match words that have not_vowel-y-not_vowel</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="fu">str_view</span>(words, <span class="st">"[^y]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] ‚îÇ &lt;a&gt;
 [2] ‚îÇ &lt;a&gt;&lt;b&gt;&lt;l&gt;&lt;e&gt;
 [3] ‚îÇ &lt;a&gt;&lt;b&gt;&lt;o&gt;&lt;u&gt;&lt;t&gt;
 [4] ‚îÇ &lt;a&gt;&lt;b&gt;&lt;s&gt;&lt;o&gt;&lt;l&gt;&lt;u&gt;&lt;t&gt;&lt;e&gt;
 [5] ‚îÇ &lt;a&gt;&lt;c&gt;&lt;c&gt;&lt;e&gt;&lt;p&gt;&lt;t&gt;
 [6] ‚îÇ &lt;a&gt;&lt;c&gt;&lt;c&gt;&lt;o&gt;&lt;u&gt;&lt;n&gt;&lt;t&gt;
 [7] ‚îÇ &lt;a&gt;&lt;c&gt;&lt;h&gt;&lt;i&gt;&lt;e&gt;&lt;v&gt;&lt;e&gt;
 [8] ‚îÇ &lt;a&gt;&lt;c&gt;&lt;r&gt;&lt;o&gt;&lt;s&gt;&lt;s&gt;
 [9] ‚îÇ &lt;a&gt;&lt;c&gt;&lt;t&gt;
[10] ‚îÇ &lt;a&gt;&lt;c&gt;&lt;t&gt;&lt;i&gt;&lt;v&gt;&lt;e&gt;
[11] ‚îÇ &lt;a&gt;&lt;c&gt;&lt;t&gt;&lt;u&gt;&lt;a&gt;&lt;l&gt;
[12] ‚îÇ &lt;a&gt;&lt;d&gt;&lt;d&gt;
[13] ‚îÇ &lt;a&gt;&lt;d&gt;&lt;d&gt;&lt;r&gt;&lt;e&gt;&lt;s&gt;&lt;s&gt;
[14] ‚îÇ &lt;a&gt;&lt;d&gt;&lt;m&gt;&lt;i&gt;&lt;t&gt;
[15] ‚îÇ &lt;a&gt;&lt;d&gt;&lt;v&gt;&lt;e&gt;&lt;r&gt;&lt;t&gt;&lt;i&gt;&lt;s&gt;&lt;e&gt;
[16] ‚îÇ &lt;a&gt;&lt;f&gt;&lt;f&gt;&lt;e&gt;&lt;c&gt;&lt;t&gt;
[17] ‚îÇ &lt;a&gt;&lt;f&gt;&lt;f&gt;&lt;o&gt;&lt;r&gt;&lt;d&gt;
[18] ‚îÇ &lt;a&gt;&lt;f&gt;&lt;t&gt;&lt;e&gt;&lt;r&gt;
[19] ‚îÇ &lt;a&gt;&lt;f&gt;&lt;t&gt;&lt;e&gt;&lt;r&gt;&lt;n&gt;&lt;o&gt;&lt;o&gt;&lt;n&gt;
[20] ‚îÇ &lt;a&gt;&lt;g&gt;&lt;a&gt;&lt;i&gt;&lt;n&gt;
... and 960 more</code></pre>
</div>
</div>
</section><section id="exploring-stringr-functions" class="level2"><h2 class="anchored" data-anchor-id="exploring-stringr-functions">Exploring <code>stringr</code> functions</h2>
<p>Read in the ‚ÄúDear Abby‚Äù data underlying The Pudding‚Äôs <a href="https://pudding.cool/2018/11/dearabby/">30 Years of American Anxieties</a> article.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>posts <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/the-pudding/data/master/dearabby/raw_da_qs.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Take a couple minutes to scroll through the <a href="https://pudding.cool/2018/11/dearabby/">30 Years of American Anxieties</a> article to get ideas for themes that you might want to search for using regular expressions.</p>
<p><br></p>
<p>The following are core <code>stringr</code> functions that use regular expressions:</p>
<ul>
<li>
<code>str_view()</code> - View the first occurrence in a string that matches the regex</li>
<li>
<code>str_count()</code> - Count the number of times a regex matches within a string</li>
<li>
<code>str_detect()</code> - Determine if (TRUE/FALSE) the regex is found within string</li>
<li>
<code>str_subset()</code> - Return subset of strings that match the regex</li>
<li>
<code>str_extract(), str_extract_all()</code> - Return portion of each string that matches the regex. <code>str_extract()</code> extracts the first instance of the match. <code>str_extract_all()</code> extracts all matches.</li>
<li>
<code>str_replace(), str_replace_all()</code> - Replace portion of string that matches the regex with something else. <code>str_replace()</code> replaces the first instance of the match. <code>str_replace_all()</code> replaces all instances of the match.</li>
<li>
<code>str_remove(), str_remove_all()</code> - Removes the portion of the string that matches the pattern. Equivalent to <code>str_replace(x, "THE REGEX PATTERN", "")</code>
</li>
</ul>
<p><strong>Exercise:</strong> Starting from <code>str_count()</code>, explore each of these functions by pulling up the function documentation page and reading through the arguments. Try out each function using the <code>posts</code> data.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb71-2"><a href="#cb71-2"></a>    <span class="at">word_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb71-3"><a href="#cb71-3"></a>    <span class="at">word =</span> <span class="fu">c</span>(<span class="st">"replace"</span>, <span class="st">"match"</span>, <span class="st">"pattern"</span>)</span>
<span id="cb71-4"><a href="#cb71-4"></a>)</span>
<span id="cb71-5"><a href="#cb71-5"></a></span>
<span id="cb71-6"><a href="#cb71-6"></a>df <span class="sc">|&gt;</span></span>
<span id="cb71-7"><a href="#cb71-7"></a>    <span class="fu">mutate</span>(</span>
<span id="cb71-8"><a href="#cb71-8"></a>        <span class="at">word_length =</span> <span class="fu">str_length</span>(word),</span>
<span id="cb71-9"><a href="#cb71-9"></a>        <span class="at">middle_pos =</span> <span class="fu">ceiling</span>(word_length<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb71-10"><a href="#cb71-10"></a>        <span class="at">middle_letter =</span> <span class="fu">str_sub</span>(word, middle_pos, middle_pos)</span>
<span id="cb71-11"><a href="#cb71-11"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 5
  word_id word    word_length middle_pos middle_letter
    &lt;int&gt; &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt; &lt;chr&gt;        
1       1 replace           7          4 l            
2       2 match             5          3 t            
3       3 pattern           7          4 t            </code></pre>
</div>
</div>
<p><strong>Exercise:</strong> Using the <code>words</code> data, find (1) words that start with ‚Äúy‚Äù and (2) words that don‚Äôt start with ‚Äúy‚Äù.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># This regex finds "a" then "b" at most once (can't have 2 or more b's in a row)</span></span>
<span id="cb73-2"><a href="#cb73-2"></a><span class="fu">str_view</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"ab"</span>, <span class="st">"abb"</span>), <span class="st">"ab?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ &lt;a&gt;
[2] ‚îÇ &lt;ab&gt;
[3] ‚îÇ &lt;ab&gt;b</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># There has to be an "a" followed by at least one b</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="co"># This is why the first string "a" isn't matched</span></span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="fu">str_view</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"ab"</span>, <span class="st">"abb"</span>), <span class="st">"ab+"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[2] ‚îÇ &lt;ab&gt;
[3] ‚îÇ &lt;abb&gt;</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># There must be an "a" and then any number of b's (including zero)</span></span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="fu">str_view</span>(<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"ab"</span>, <span class="st">"abb"</span>), <span class="st">"ab*"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] ‚îÇ &lt;a&gt;
[2] ‚îÇ &lt;ab&gt;
[3] ‚îÇ &lt;abb&gt;</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">str_view</span>(words, <span class="st">"[aeiou][aeiou]m"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[154] ‚îÇ cl&lt;aim&gt;
[714] ‚îÇ r&lt;oom&gt;
[735] ‚îÇ s&lt;eem&gt;
[844] ‚îÇ t&lt;eam&gt;</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">str_view</span>(fruit, <span class="st">"aa|ee|ii|oo|uu"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [9] ‚îÇ bl&lt;oo&gt;d orange
[33] ‚îÇ g&lt;oo&gt;seberry
[47] ‚îÇ lych&lt;ee&gt;
[66] ‚îÇ purple mangost&lt;ee&gt;n</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="co"># Words that start with y</span></span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="fu">str_view</span>(words, <span class="st">"^y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[975] ‚îÇ &lt;y&gt;ear
[976] ‚îÇ &lt;y&gt;es
[977] ‚îÇ &lt;y&gt;esterday
[978] ‚îÇ &lt;y&gt;et
[979] ‚îÇ &lt;y&gt;ou
[980] ‚îÇ &lt;y&gt;oung</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="co"># Words that don't start with y</span></span>
<span id="cb85-2"><a href="#cb85-2"></a><span class="fu">str_view</span>(words, <span class="st">"^[^y]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] ‚îÇ &lt;a&gt;
 [2] ‚îÇ &lt;a&gt;ble
 [3] ‚îÇ &lt;a&gt;bout
 [4] ‚îÇ &lt;a&gt;bsolute
 [5] ‚îÇ &lt;a&gt;ccept
 [6] ‚îÇ &lt;a&gt;ccount
 [7] ‚îÇ &lt;a&gt;chieve
 [8] ‚îÇ &lt;a&gt;cross
 [9] ‚îÇ &lt;a&gt;ct
[10] ‚îÇ &lt;a&gt;ctive
[11] ‚îÇ &lt;a&gt;ctual
[12] ‚îÇ &lt;a&gt;dd
[13] ‚îÇ &lt;a&gt;ddress
[14] ‚îÇ &lt;a&gt;dmit
[15] ‚îÇ &lt;a&gt;dvertise
[16] ‚îÇ &lt;a&gt;ffect
[17] ‚îÇ &lt;a&gt;fford
[18] ‚îÇ &lt;a&gt;fter
[19] ‚îÇ &lt;a&gt;fternoon
[20] ‚îÇ &lt;a&gt;gain
... and 954 more</code></pre>
</div>
</div>
</section><section id="done" class="level2"><h2 class="anchored" data-anchor-id="done">Done!</h2>
<ul>
<li>Check the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website</li>
</ul>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="../../src/ica/04-adv-maps-1-notes.html" class="pagination-link" aria-label="4 Adv Spatial Viz P1">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">4 Adv Spatial Viz P1</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../src/appx/appx-sample1.html" class="pagination-link" aria-label="Appendix Sample 1">
        <span class="nav-page-text"><span class="chapter-title">Appendix Sample 1</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb87" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb87-1"><a href="#cb87-1"></a><span class="co">---</span></span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="an">title:</span><span class="co"> "7 Adv Data wrangling P2"</span></span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="co">---</span></span>
<span id="cb87-4"><a href="#cb87-4"></a></span>
<span id="cb87-5"><a href="#cb87-5"></a></span>
<span id="cb87-6"><a href="#cb87-6"></a><span class="in">```{r doc_setup_07, echo=FALSE, message=FALSE}</span></span>
<span id="cb87-7"><a href="#cb87-7"></a><span class="in">library(tidyverse) # The stringr package is part of tidyverse</span></span>
<span id="cb87-8"><a href="#cb87-8"></a><span class="in">```</span></span>
<span id="cb87-9"><a href="#cb87-9"></a></span>
<span id="cb87-10"><a href="#cb87-10"></a></span>
<span id="cb87-11"><a href="#cb87-11"></a><span class="fu">## üß© Learning Goals</span></span>
<span id="cb87-12"><a href="#cb87-12"></a></span>
<span id="cb87-13"><a href="#cb87-13"></a>By the end of this lesson, you should be able to:</span>
<span id="cb87-14"><a href="#cb87-14"></a></span>
<span id="cb87-15"><a href="#cb87-15"></a><span class="ss">- </span>Manipulate and explore strings using the <span class="in">`stringr`</span> package</span>
<span id="cb87-16"><a href="#cb87-16"></a><span class="ss">- </span>Construct regular expressions to find patterns in strings</span>
<span id="cb87-17"><a href="#cb87-17"></a></span>
<span id="cb87-18"><a href="#cb87-18"></a></span>
<span id="cb87-19"><a href="#cb87-19"></a><span class="fu">## Helpful Cheatsheets </span></span>
<span id="cb87-20"><a href="#cb87-20"></a></span>
<span id="cb87-21"><a href="#cb87-21"></a>The <span class="in">`stringr`</span> cheatsheet (<span class="co">[</span><span class="ot">HTML</span><span class="co">](https://rstudio.github.io/cheatsheets/html/strings.html)</span>, <span class="co">[</span><span class="ot">PDF</span><span class="co">](https://rstudio.github.io/cheatsheets/strings.pdf)</span>) will be useful to have open and reference.</span>
<span id="cb87-22"><a href="#cb87-22"></a></span>
<span id="cb87-23"><a href="#cb87-23"></a></span>
<span id="cb87-24"><a href="#cb87-24"></a></span>
<span id="cb87-25"><a href="#cb87-25"></a><span class="fu">## Motivation: 30 Years of American Anxieties </span></span>
<span id="cb87-26"><a href="#cb87-26"></a></span>
<span id="cb87-27"><a href="#cb87-27"></a>In 2018 the data journalism organization <span class="co">[</span><span class="ot">The Pudding</span><span class="co">](https://pudding.cool/)</span> featured a story called <span class="co">[</span><span class="ot">30 Years of American Anxieties</span><span class="co">](https://pudding.cool/2018/11/dearabby/)</span> about themes in 30 years of posts to the Dear Abby column (an American advice column).</span>
<span id="cb87-28"><a href="#cb87-28"></a></span>
<span id="cb87-29"><a href="#cb87-29"></a>One way to understand themes in text data is to conduct a **qualitative analysis**, a methodology in which multiple readers read through instances of text several times to reach a consensus about themes.</span>
<span id="cb87-30"><a href="#cb87-30"></a></span>
<span id="cb87-31"><a href="#cb87-31"></a>Another way to understand themes in text data is **computational text analysis**. </span>
<span id="cb87-32"><a href="#cb87-32"></a></span>
<span id="cb87-33"><a href="#cb87-33"></a><span class="ss">- </span>This is what we will explore today. </span>
<span id="cb87-34"><a href="#cb87-34"></a></span>
<span id="cb87-35"><a href="#cb87-35"></a></span>
<span id="cb87-36"><a href="#cb87-36"></a>Both qualitative analysis and computational tools can be used in tandem. Often, using computational tools can help focus a close reading of select texts, which parallels the spirit of a qualitative analysis.</span>
<span id="cb87-37"><a href="#cb87-37"></a></span>
<span id="cb87-38"><a href="#cb87-38"></a>To prepare ourselves for a computational analysis, let's learn about strings.</span>
<span id="cb87-39"><a href="#cb87-39"></a></span>
<span id="cb87-40"><a href="#cb87-40"></a></span>
<span id="cb87-41"><a href="#cb87-41"></a></span>
<span id="cb87-42"><a href="#cb87-42"></a><span class="fu">## Strings </span></span>
<span id="cb87-43"><a href="#cb87-43"></a></span>
<span id="cb87-44"><a href="#cb87-44"></a>Strings are objects of the <span class="in">`character`</span> class (abbreviated as <span class="in">`&lt;chr&gt;`</span> in tibbles). </span>
<span id="cb87-45"><a href="#cb87-45"></a></span>
<span id="cb87-46"><a href="#cb87-46"></a>When you print out strings, they display with double quotes:</span>
<span id="cb87-47"><a href="#cb87-47"></a></span>
<span id="cb87-48"><a href="#cb87-48"></a><span class="in">```{r chr_class}</span></span>
<span id="cb87-49"><a href="#cb87-49"></a><span class="in">some_string &lt;- "banana"</span></span>
<span id="cb87-50"><a href="#cb87-50"></a><span class="in">some_string</span></span>
<span id="cb87-51"><a href="#cb87-51"></a><span class="in">```</span></span>
<span id="cb87-52"><a href="#cb87-52"></a></span>
<span id="cb87-53"><a href="#cb87-53"></a></span>
<span id="cb87-54"><a href="#cb87-54"></a>Working with strings generally will involve the use of **regular expressions**, a tool for finding patterns in strings. </span>
<span id="cb87-55"><a href="#cb87-55"></a></span>
<span id="cb87-56"><a href="#cb87-56"></a></span>
<span id="cb87-57"><a href="#cb87-57"></a>Regular expressions (regex, for short) look like the following:</span>
<span id="cb87-58"><a href="#cb87-58"></a></span>
<span id="cb87-59"><a href="#cb87-59"></a><span class="in">```</span></span>
<span id="cb87-60"><a href="#cb87-60"></a><span class="in">"^the" (Strings that start with "the")</span></span>
<span id="cb87-61"><a href="#cb87-61"></a><span class="in">"end$" (Strings that end with "end")</span></span>
<span id="cb87-62"><a href="#cb87-62"></a><span class="in">```</span></span>
<span id="cb87-63"><a href="#cb87-63"></a></span>
<span id="cb87-64"><a href="#cb87-64"></a>Before getting to regular expressions, let's go over some fundamentals about working with strings. The <span class="in">`stringr`</span> package (available within <span class="in">`tidyverse`</span>) is great for working with strings.</span>
<span id="cb87-65"><a href="#cb87-65"></a></span>
<span id="cb87-66"><a href="#cb87-66"></a><span class="fu">## Creating strings </span></span>
<span id="cb87-67"><a href="#cb87-67"></a></span>
<span id="cb87-68"><a href="#cb87-68"></a>Creating strings by hand is useful for testing out regular expressions.</span>
<span id="cb87-69"><a href="#cb87-69"></a></span>
<span id="cb87-70"><a href="#cb87-70"></a>To create a string, type any text in either double quotes (<span class="in">`"`</span>) or single quotes <span class="in">`'`</span>. Using double or single quotes doesn't matter unless your string itself has single or double quotes.</span>
<span id="cb87-71"><a href="#cb87-71"></a></span>
<span id="cb87-72"><a href="#cb87-72"></a><span class="in">```{r create_strings}</span></span>
<span id="cb87-73"><a href="#cb87-73"></a><span class="in">string1 &lt;- "This is a string"</span></span>
<span id="cb87-74"><a href="#cb87-74"></a><span class="in">string2 &lt;- 'If I want to include a "quote" inside a string, I use single quotes'</span></span>
<span id="cb87-75"><a href="#cb87-75"></a><span class="in">string3 &lt;- c(string1, string2) # string / character vector (of greater than length 1)</span></span>
<span id="cb87-76"><a href="#cb87-76"></a></span>
<span id="cb87-77"><a href="#cb87-77"></a></span>
<span id="cb87-78"><a href="#cb87-78"></a><span class="in">class(string1)</span></span>
<span id="cb87-79"><a href="#cb87-79"></a><span class="in">class(string2)</span></span>
<span id="cb87-80"><a href="#cb87-80"></a><span class="in">class(string3)</span></span>
<span id="cb87-81"><a href="#cb87-81"></a></span>
<span id="cb87-82"><a href="#cb87-82"></a><span class="in">length(string1)</span></span>
<span id="cb87-83"><a href="#cb87-83"></a><span class="in">length(string2)</span></span>
<span id="cb87-84"><a href="#cb87-84"></a><span class="in">length(string3)</span></span>
<span id="cb87-85"><a href="#cb87-85"></a><span class="in">```</span></span>
<span id="cb87-86"><a href="#cb87-86"></a></span>
<span id="cb87-87"><a href="#cb87-87"></a></span>
<span id="cb87-88"><a href="#cb87-88"></a>We can view these strings "naturally" (without the opening and closing quotes) with <span class="in">`str_view()`</span>:</span>
<span id="cb87-89"><a href="#cb87-89"></a></span>
<span id="cb87-90"><a href="#cb87-90"></a><span class="in">```{r str_view}</span></span>
<span id="cb87-91"><a href="#cb87-91"></a><span class="in">str_view(string1)</span></span>
<span id="cb87-92"><a href="#cb87-92"></a><span class="in">str_view(string2)</span></span>
<span id="cb87-93"><a href="#cb87-93"></a><span class="in">str_view(string3)</span></span>
<span id="cb87-94"><a href="#cb87-94"></a><span class="in">```</span></span>
<span id="cb87-95"><a href="#cb87-95"></a></span>
<span id="cb87-96"><a href="#cb87-96"></a>**Exercise:** Create the string <span class="in">`It's Thursday`</span>. What happens if you put the string inside single quotes? Double quotes?</span>
<span id="cb87-97"><a href="#cb87-97"></a></span>
<span id="cb87-98"><a href="#cb87-98"></a><span class="in">```{r ex_create_string}</span></span>
<span id="cb87-99"><a href="#cb87-99"></a><span class="in"># Your code</span></span>
<span id="cb87-100"><a href="#cb87-100"></a><span class="in">string1 &lt;- "It's Thursday"</span></span>
<span id="cb87-101"><a href="#cb87-101"></a></span>
<span id="cb87-102"><a href="#cb87-102"></a></span>
<span id="cb87-103"><a href="#cb87-103"></a><span class="in">```</span></span>
<span id="cb87-104"><a href="#cb87-104"></a></span>
<span id="cb87-105"><a href="#cb87-105"></a>It doesn't work with single quotes because it thinks it ends the string after It.</span>
<span id="cb87-106"><a href="#cb87-106"></a>Because <span class="in">`"`</span> and <span class="in">`'`</span> are special characters in the creation of strings, R offers another way to put them inside a string. We can **escape** these special characters by putting a <span class="in">`\`</span> in front of them:</span>
<span id="cb87-107"><a href="#cb87-107"></a></span>
<span id="cb87-108"><a href="#cb87-108"></a><span class="in">```{r escape_chars}</span></span>
<span id="cb87-109"><a href="#cb87-109"></a><span class="in">string1 &lt;- "This is a string with \"double quotes\""</span></span>
<span id="cb87-110"><a href="#cb87-110"></a><span class="in">string2 &lt;- "This is a string with \'single quotes\'"</span></span>
<span id="cb87-111"><a href="#cb87-111"></a><span class="in">str_view(string1)</span></span>
<span id="cb87-112"><a href="#cb87-112"></a><span class="in">str_view(string2)</span></span>
<span id="cb87-113"><a href="#cb87-113"></a><span class="in">```</span></span>
<span id="cb87-114"><a href="#cb87-114"></a></span>
<span id="cb87-115"><a href="#cb87-115"></a></span>
<span id="cb87-116"><a href="#cb87-116"></a>Given that <span class="in">`\`</span> is a special character, how can we put the <span class="in">`\`</span> character in strings? We have to escape it with <span class="in">`\\`</span>.</span>
<span id="cb87-117"><a href="#cb87-117"></a></span>
<span id="cb87-118"><a href="#cb87-118"></a>**Exercise:** Create the string <span class="in">`C:\Users`</span>. What happens when you don't escape the <span class="in">`\`</span>?</span>
<span id="cb87-119"><a href="#cb87-119"></a></span>
<span id="cb87-120"><a href="#cb87-120"></a><span class="in">```{r ex_create_string_slash}</span></span>
<span id="cb87-121"><a href="#cb87-121"></a><span class="in"># Your code</span></span>
<span id="cb87-122"><a href="#cb87-122"></a><span class="in">#string1 &lt;- 'C:\Users'</span></span>
<span id="cb87-123"><a href="#cb87-123"></a><span class="in">string2 &lt;- 'C:\\Users'</span></span>
<span id="cb87-124"><a href="#cb87-124"></a><span class="in">str_view(string2)</span></span>
<span id="cb87-125"><a href="#cb87-125"></a></span>
<span id="cb87-126"><a href="#cb87-126"></a><span class="in">```</span></span>
<span id="cb87-127"><a href="#cb87-127"></a></span>
<span id="cb87-128"><a href="#cb87-128"></a>If you fail to escape, you get an error</span>
<span id="cb87-129"><a href="#cb87-129"></a>Other special characters include:</span>
<span id="cb87-130"><a href="#cb87-130"></a></span>
<span id="cb87-131"><a href="#cb87-131"></a><span class="ss">- </span><span class="in">`\t`</span> (Creates a tab)</span>
<span id="cb87-132"><a href="#cb87-132"></a><span class="ss">- </span><span class="in">`\n`</span> (Creates a newline)</span>
<span id="cb87-133"><a href="#cb87-133"></a></span>
<span id="cb87-134"><a href="#cb87-134"></a>Both can be useful in plots to more neatly arrange text.</span>
<span id="cb87-135"><a href="#cb87-135"></a></span>
<span id="cb87-136"><a href="#cb87-136"></a><span class="in">```{r escape_tab_newline}</span></span>
<span id="cb87-137"><a href="#cb87-137"></a><span class="in">string1 &lt;- "Record temp:\t102"</span></span>
<span id="cb87-138"><a href="#cb87-138"></a><span class="in">string2 &lt;- "Record temp:\n102"</span></span>
<span id="cb87-139"><a href="#cb87-139"></a></span>
<span id="cb87-140"><a href="#cb87-140"></a><span class="in">str_view(string1)</span></span>
<span id="cb87-141"><a href="#cb87-141"></a><span class="in">str_view(string2)</span></span>
<span id="cb87-142"><a href="#cb87-142"></a><span class="in">```</span></span>
<span id="cb87-143"><a href="#cb87-143"></a></span>
<span id="cb87-144"><a href="#cb87-144"></a>Can we get <span class="in">`str_view()`</span> to show the tab instead of <span class="in">`{\t}`</span>? We can use the <span class="in">`html`</span> argument to have the string displayed as if on a webpage:</span>
<span id="cb87-145"><a href="#cb87-145"></a></span>
<span id="cb87-146"><a href="#cb87-146"></a><span class="in">```{r str_view_html, eval=FALSE}</span></span>
<span id="cb87-147"><a href="#cb87-147"></a><span class="in">str_view(string1, html = TRUE)</span></span>
<span id="cb87-148"><a href="#cb87-148"></a><span class="in">```</span></span>
<span id="cb87-149"><a href="#cb87-149"></a></span>
<span id="cb87-150"><a href="#cb87-150"></a></span>
<span id="cb87-151"><a href="#cb87-151"></a>Often we will want to create new strings within data frames. We can use <span class="in">`str_c()`</span> or <span class="in">`str_glue()`</span>, both of which are vectorized functions (meaning they take vectors as inputs and provide vectors as outputs - can be used within <span class="in">`mutate()`</span>):</span>
<span id="cb87-152"><a href="#cb87-152"></a></span>
<span id="cb87-153"><a href="#cb87-153"></a><span class="ss">- </span>With <span class="in">`str_c()`</span> the strings to be combined are all separate arguments separated by commas.</span>
<span id="cb87-154"><a href="#cb87-154"></a><span class="ss">- </span>With <span class="in">`str_glue()`</span> the desired string is written as a template with variable names inside curly braces <span class="in">`{}`</span>.</span>
<span id="cb87-155"><a href="#cb87-155"></a></span>
<span id="cb87-156"><a href="#cb87-156"></a></span>
<span id="cb87-157"><a href="#cb87-157"></a><span class="in">```{r str_c_glue}</span></span>
<span id="cb87-158"><a href="#cb87-158"></a><span class="in">df &lt;- tibble(</span></span>
<span id="cb87-159"><a href="#cb87-159"></a><span class="in">    first_name = c("Arya", "Olenna", "Tyrion", "Melisandre"),</span></span>
<span id="cb87-160"><a href="#cb87-160"></a><span class="in">    last_name = c("Stark", "Tyrell", "Lannister", NA)</span></span>
<span id="cb87-161"><a href="#cb87-161"></a><span class="in">)</span></span>
<span id="cb87-162"><a href="#cb87-162"></a><span class="in">df</span></span>
<span id="cb87-163"><a href="#cb87-163"></a></span>
<span id="cb87-164"><a href="#cb87-164"></a><span class="in">df |&gt;</span></span>
<span id="cb87-165"><a href="#cb87-165"></a><span class="in">    mutate(</span></span>
<span id="cb87-166"><a href="#cb87-166"></a><span class="in">        full_name1 = str_c(first_name, " ", last_name),</span></span>
<span id="cb87-167"><a href="#cb87-167"></a><span class="in">        full_name2 = str_glue("{first_name} {last_name}")</span></span>
<span id="cb87-168"><a href="#cb87-168"></a><span class="in">    )</span></span>
<span id="cb87-169"><a href="#cb87-169"></a><span class="in">```</span></span>
<span id="cb87-170"><a href="#cb87-170"></a></span>
<span id="cb87-171"><a href="#cb87-171"></a>**Exercise:** In the following data frame, create a full date string in month-day-year format using both <span class="in">`str_c()`</span> and <span class="in">`str_glue()`</span>.</span>
<span id="cb87-172"><a href="#cb87-172"></a></span>
<span id="cb87-173"><a href="#cb87-173"></a><span class="in">```{r ex_str_c_glue}</span></span>
<span id="cb87-174"><a href="#cb87-174"></a><span class="in">df_dates &lt;- tibble(</span></span>
<span id="cb87-175"><a href="#cb87-175"></a><span class="in">    year = c(2000, 2001, 2002),</span></span>
<span id="cb87-176"><a href="#cb87-176"></a><span class="in">    month = c("Jan", "Feb", "Mar"),</span></span>
<span id="cb87-177"><a href="#cb87-177"></a><span class="in">    day = c(3, 4, 5)</span></span>
<span id="cb87-178"><a href="#cb87-178"></a><span class="in">)</span></span>
<span id="cb87-179"><a href="#cb87-179"></a></span>
<span id="cb87-180"><a href="#cb87-180"></a></span>
<span id="cb87-181"><a href="#cb87-181"></a><span class="in">df_dates |&gt;</span></span>
<span id="cb87-182"><a href="#cb87-182"></a><span class="in">    mutate(</span></span>
<span id="cb87-183"><a href="#cb87-183"></a><span class="in">        full_name1 = str_c(month, " ",day, " ",year),</span></span>
<span id="cb87-184"><a href="#cb87-184"></a><span class="in">        full_name2 = str_glue("{month} {day}{year}")</span></span>
<span id="cb87-185"><a href="#cb87-185"></a><span class="in">    )</span></span>
<span id="cb87-186"><a href="#cb87-186"></a></span>
<span id="cb87-187"><a href="#cb87-187"></a><span class="in">```</span></span>
<span id="cb87-188"><a href="#cb87-188"></a></span>
<span id="cb87-189"><a href="#cb87-189"></a></span>
<span id="cb87-190"><a href="#cb87-190"></a></span>
<span id="cb87-191"><a href="#cb87-191"></a><span class="fu">## Extracting information from strings   </span></span>
<span id="cb87-192"><a href="#cb87-192"></a></span>
<span id="cb87-193"><a href="#cb87-193"></a>The <span class="in">`str_length()`</span> counts the number of characters in a string.</span>
<span id="cb87-194"><a href="#cb87-194"></a></span>
<span id="cb87-195"><a href="#cb87-195"></a><span class="in">```{r str_length}</span></span>
<span id="cb87-196"><a href="#cb87-196"></a><span class="in">comments &lt;- tibble(</span></span>
<span id="cb87-197"><a href="#cb87-197"></a><span class="in">    name = c("Alice", "Bob"),</span></span>
<span id="cb87-198"><a href="#cb87-198"></a><span class="in">    comment = c("The essay was well organized around the core message and had good transitions.", "Good job!")</span></span>
<span id="cb87-199"><a href="#cb87-199"></a><span class="in">)</span></span>
<span id="cb87-200"><a href="#cb87-200"></a></span>
<span id="cb87-201"><a href="#cb87-201"></a><span class="in">comments |&gt;</span></span>
<span id="cb87-202"><a href="#cb87-202"></a><span class="in">    mutate(</span></span>
<span id="cb87-203"><a href="#cb87-203"></a><span class="in">        comment_length = str_length(comment)</span></span>
<span id="cb87-204"><a href="#cb87-204"></a><span class="in">    )</span></span>
<span id="cb87-205"><a href="#cb87-205"></a><span class="in">```</span></span>
<span id="cb87-206"><a href="#cb87-206"></a></span>
<span id="cb87-207"><a href="#cb87-207"></a></span>
<span id="cb87-208"><a href="#cb87-208"></a>The <span class="in">`str_sub()`</span> function gets a substring of a string. The 2nd and 3rd arguments indicate the beginning and ending position to extract.</span>
<span id="cb87-209"><a href="#cb87-209"></a></span>
<span id="cb87-210"><a href="#cb87-210"></a><span class="ss">- </span>Negative positions indicate the position from the end of the word. (e.g., -3 indicates "3rd letter from the end")</span>
<span id="cb87-211"><a href="#cb87-211"></a><span class="ss">- </span>Specifying a position that goes beyond the word won't result in an error. <span class="in">`str_sub()`</span> will just go as far as possible.</span>
<span id="cb87-212"><a href="#cb87-212"></a></span>
<span id="cb87-213"><a href="#cb87-213"></a><span class="in">```{r str_sub}</span></span>
<span id="cb87-214"><a href="#cb87-214"></a><span class="in">x &lt;- c("Apple", "Banana", "Pear")</span></span>
<span id="cb87-215"><a href="#cb87-215"></a></span>
<span id="cb87-216"><a href="#cb87-216"></a><span class="in">str_sub(x, start = 1, end = 3)</span></span>
<span id="cb87-217"><a href="#cb87-217"></a><span class="in">str_sub(x, start = -3, end = -1)</span></span>
<span id="cb87-218"><a href="#cb87-218"></a><span class="in">str_sub(x, start = 2, end = -1)</span></span>
<span id="cb87-219"><a href="#cb87-219"></a><span class="in">str_sub("a", start = 1, end = 15)</span></span>
<span id="cb87-220"><a href="#cb87-220"></a><span class="in">```</span></span>
<span id="cb87-221"><a href="#cb87-221"></a></span>
<span id="cb87-222"><a href="#cb87-222"></a></span>
<span id="cb87-223"><a href="#cb87-223"></a>**Exercise:** Using <span class="in">`str_sub()`</span>, create a new variable with only the middle letter of each word in the data frame below. (Challenge: How would you handle words with an even number of letters?)</span>
<span id="cb87-224"><a href="#cb87-224"></a></span>
<span id="cb87-225"><a href="#cb87-225"></a><span class="in">```{r ex_str_sub}</span></span>
<span id="cb87-226"><a href="#cb87-226"></a><span class="in">library(tidyverse)</span></span>
<span id="cb87-227"><a href="#cb87-227"></a></span>
<span id="cb87-228"><a href="#cb87-228"></a><span class="in">df &lt;- tibble(</span></span>
<span id="cb87-229"><a href="#cb87-229"></a><span class="in">  word_id = 1:3,</span></span>
<span id="cb87-230"><a href="#cb87-230"></a><span class="in">  word = c("replace", "match", "pattern")</span></span>
<span id="cb87-231"><a href="#cb87-231"></a><span class="in">)</span></span>
<span id="cb87-232"><a href="#cb87-232"></a></span>
<span id="cb87-233"><a href="#cb87-233"></a><span class="in"># Create a new variable with the middle letter</span></span>
<span id="cb87-234"><a href="#cb87-234"></a><span class="in">df %&gt;%</span></span>
<span id="cb87-235"><a href="#cb87-235"></a><span class="in">  mutate(</span></span>
<span id="cb87-236"><a href="#cb87-236"></a><span class="in">    middle_letter = str_sub(word,</span></span>
<span id="cb87-237"><a href="#cb87-237"></a><span class="in">      start = (str_length(word) + 1) / 2,</span></span>
<span id="cb87-238"><a href="#cb87-238"></a><span class="in">      end = (str_length(word) + 1) / 2</span></span>
<span id="cb87-239"><a href="#cb87-239"></a><span class="in">    )</span></span>
<span id="cb87-240"><a href="#cb87-240"></a><span class="in">  )</span></span>
<span id="cb87-241"><a href="#cb87-241"></a></span>
<span id="cb87-242"><a href="#cb87-242"></a><span class="in">```</span></span>
<span id="cb87-243"><a href="#cb87-243"></a></span>
<span id="cb87-244"><a href="#cb87-244"></a></span>
<span id="cb87-245"><a href="#cb87-245"></a></span>
<span id="cb87-246"><a href="#cb87-246"></a><span class="fu">## Finding patterns in strings with regular expressions </span></span>
<span id="cb87-247"><a href="#cb87-247"></a></span>
<span id="cb87-248"><a href="#cb87-248"></a>Suppose that you're exploring text data looking for places where people describe happiness. There are many ways to search. We could search for the word "happy" but that excludes "happiness" so we might search for "happi".</span>
<span id="cb87-249"><a href="#cb87-249"></a></span>
<span id="cb87-250"><a href="#cb87-250"></a>**Regular expressions** (regex) are a powerful language for describing patterns within strings.</span>
<span id="cb87-251"><a href="#cb87-251"></a></span>
<span id="cb87-252"><a href="#cb87-252"></a>. . .</span>
<span id="cb87-253"><a href="#cb87-253"></a></span>
<span id="cb87-254"><a href="#cb87-254"></a><span class="in">```{r load_regex_data}</span></span>
<span id="cb87-255"><a href="#cb87-255"></a><span class="in">data(fruit)</span></span>
<span id="cb87-256"><a href="#cb87-256"></a><span class="in">data(words)</span></span>
<span id="cb87-257"><a href="#cb87-257"></a><span class="in">data(sentences)</span></span>
<span id="cb87-258"><a href="#cb87-258"></a><span class="in">```</span></span>
<span id="cb87-259"><a href="#cb87-259"></a></span>
<span id="cb87-260"><a href="#cb87-260"></a>We can use <span class="in">`str_view()`</span> with the <span class="in">`pattern`</span> argument to see what parts of a string match the regex supplied in the <span class="in">`pattern`</span> argument. (Matches are enclosed in <span class="in">`&lt;&gt;`</span>.)</span>
<span id="cb87-261"><a href="#cb87-261"></a></span>
<span id="cb87-262"><a href="#cb87-262"></a><span class="in">```{r str_view_pattern}</span></span>
<span id="cb87-263"><a href="#cb87-263"></a><span class="in">str_view(fruit, "berry")</span></span>
<span id="cb87-264"><a href="#cb87-264"></a><span class="in">```</span></span>
<span id="cb87-265"><a href="#cb87-265"></a></span>
<span id="cb87-266"><a href="#cb87-266"></a></span>
<span id="cb87-267"><a href="#cb87-267"></a>**Essentials of forming a regex**</span>
<span id="cb87-268"><a href="#cb87-268"></a></span>
<span id="cb87-269"><a href="#cb87-269"></a><span class="ss">- </span>Letters and numbers in a regex are matched exactly and are called **literal characters**.</span>
<span id="cb87-270"><a href="#cb87-270"></a><span class="ss">- </span>Most punctuation characters, like <span class="in">`.`</span>, <span class="in">`+`</span>, <span class="in">`*`</span>, <span class="in">`[`</span>, <span class="in">`]`</span>, and <span class="in">`?`</span>, have special meanings and are called **metacharacters**.</span>
<span id="cb87-271"><a href="#cb87-271"></a><span class="ss">- </span>**Quantifiers** come after a regex and control how many times a pattern can match:</span>
<span id="cb87-272"><a href="#cb87-272"></a><span class="ss">    - </span><span class="in">`?`</span>: match the preceding pattern 0 or 1 times</span>
<span id="cb87-273"><a href="#cb87-273"></a><span class="ss">    - </span><span class="in">`+`</span>: match the preceding pattern at least once</span>
<span id="cb87-274"><a href="#cb87-274"></a><span class="ss">    - </span><span class="in">`*`</span>: match the preceding pattern at least 0 times (any number of times)</span>
<span id="cb87-275"><a href="#cb87-275"></a>    </span>
<span id="cb87-276"><a href="#cb87-276"></a>. . .</span>
<span id="cb87-277"><a href="#cb87-277"></a></span>
<span id="cb87-278"><a href="#cb87-278"></a>**Exercise:** Before running the code below, predict what matches will be made. Run the code to check your guesses. Note that in all regex's below the <span class="in">`?, +, *`</span> applies to the <span class="in">`b`</span> only (not the <span class="in">`a`</span>).</span>
<span id="cb87-279"><a href="#cb87-279"></a></span>
<span id="cb87-280"><a href="#cb87-280"></a><span class="in">```{r ex_regex_quantifiers}</span></span>
<span id="cb87-281"><a href="#cb87-281"></a><span class="in">#| eval: false</span></span>
<span id="cb87-282"><a href="#cb87-282"></a><span class="in">str_view(c("a", "ab", "abb"), "ab?")</span></span>
<span id="cb87-283"><a href="#cb87-283"></a><span class="in">str_view(c("a", "ab", "abb"), "ab+")</span></span>
<span id="cb87-284"><a href="#cb87-284"></a><span class="in">str_view(c("a", "ab", "abb"), "ab*")</span></span>
<span id="cb87-285"><a href="#cb87-285"></a><span class="in">```</span></span>
<span id="cb87-286"><a href="#cb87-286"></a></span>
<span id="cb87-287"><a href="#cb87-287"></a></span>
<span id="cb87-288"><a href="#cb87-288"></a><span class="ss">- </span>We can match any of a set of characters with <span class="in">`[]`</span> (called a **character class**), e.g., <span class="in">`[abcd]`</span> matches "a", "b", "c", or "d".</span>
<span id="cb87-289"><a href="#cb87-289"></a><span class="ss">    - </span>We can invert the match by starting with <span class="in">`^`</span>: <span class="in">`[^abcd]`</span> matches anything except "a", "b", "c", or "d".</span>
<span id="cb87-290"><a href="#cb87-290"></a></span>
<span id="cb87-291"><a href="#cb87-291"></a><span class="in">```{r regex_classes}</span></span>
<span id="cb87-292"><a href="#cb87-292"></a><span class="in"># Match words that have vowel-x-vowel</span></span>
<span id="cb87-293"><a href="#cb87-293"></a><span class="in">str_view(words, "[aeiou]x[aeiou]")</span></span>
<span id="cb87-294"><a href="#cb87-294"></a></span>
<span id="cb87-295"><a href="#cb87-295"></a><span class="in"># Match words that have not_vowel-y-not_vowel</span></span>
<span id="cb87-296"><a href="#cb87-296"></a><span class="in">str_view(words, "[^aeiou]y[^aeiou]")</span></span>
<span id="cb87-297"><a href="#cb87-297"></a><span class="in">```</span></span>
<span id="cb87-298"><a href="#cb87-298"></a></span>
<span id="cb87-299"><a href="#cb87-299"></a></span>
<span id="cb87-300"><a href="#cb87-300"></a>**Exercise** Using the <span class="in">`words`</span> data, find words that have two vowels in a row followed by an "m".</span>
<span id="cb87-301"><a href="#cb87-301"></a></span>
<span id="cb87-302"><a href="#cb87-302"></a><span class="in">```{r ex_regex_classes}</span></span>
<span id="cb87-303"><a href="#cb87-303"></a><span class="in"># Your code</span></span>
<span id="cb87-304"><a href="#cb87-304"></a><span class="in">str_view(words, "[aeiou][aeiou]m")</span></span>
<span id="cb87-305"><a href="#cb87-305"></a></span>
<span id="cb87-306"><a href="#cb87-306"></a></span>
<span id="cb87-307"><a href="#cb87-307"></a><span class="in">```</span></span>
<span id="cb87-308"><a href="#cb87-308"></a></span>
<span id="cb87-309"><a href="#cb87-309"></a></span>
<span id="cb87-310"><a href="#cb87-310"></a></span>
<span id="cb87-311"><a href="#cb87-311"></a></span>
<span id="cb87-312"><a href="#cb87-312"></a><span class="ss">- </span>The **alternation** operator <span class="in">`|`</span> can be read just like the logical operator <span class="in">`|`</span> ("OR") to pick between one or more alternative patterns. e.g., <span class="in">`apple|banana`</span> searches for "apple" or "banana".</span>
<span id="cb87-313"><a href="#cb87-313"></a></span>
<span id="cb87-314"><a href="#cb87-314"></a><span class="in">```{r regex_alternation}</span></span>
<span id="cb87-315"><a href="#cb87-315"></a><span class="in">str_view(fruit, "apple|melon|nut")</span></span>
<span id="cb87-316"><a href="#cb87-316"></a><span class="in">```</span></span>
<span id="cb87-317"><a href="#cb87-317"></a></span>
<span id="cb87-318"><a href="#cb87-318"></a></span>
<span id="cb87-319"><a href="#cb87-319"></a>**Exercise:** Using the <span class="in">`fruit`</span> data, find fruits that have a repeated vowel ("aa", "ee", "ii", "oo", or "uu".)</span>
<span id="cb87-320"><a href="#cb87-320"></a></span>
<span id="cb87-321"><a href="#cb87-321"></a><span class="in">```{r ex_regex_alternation}</span></span>
<span id="cb87-322"><a href="#cb87-322"></a><span class="in"># Your code</span></span>
<span id="cb87-323"><a href="#cb87-323"></a><span class="in">str_view(fruit, "aa|ee|ii|oo|uu")</span></span>
<span id="cb87-324"><a href="#cb87-324"></a></span>
<span id="cb87-325"><a href="#cb87-325"></a><span class="in">```</span></span>
<span id="cb87-326"><a href="#cb87-326"></a></span>
<span id="cb87-327"><a href="#cb87-327"></a></span>
<span id="cb87-328"><a href="#cb87-328"></a><span class="ss">- </span>The <span class="in">`^`</span> operator indicates the beginning of a string, and the <span class="in">`$`</span> operator indicates the end of a string. e.g., <span class="in">`^a`</span> matches strings that start with "a", and <span class="in">`a$`</span> matches words that end with "a".</span>
<span id="cb87-329"><a href="#cb87-329"></a><span class="ss">- </span>Parentheses group together parts of a regular expression that should be taken as a bundle. (Much like parentheses in arithmetic statements.)</span>
<span id="cb87-330"><a href="#cb87-330"></a><span class="ss">    - </span>e.g., <span class="in">`ab+`</span> is a little confusing. Does it match "ab" one or more times? Or does it match "a" first, then just "b" one or more times? (The latter, as we saw in an earlier example.) We can be very explicit and use <span class="in">`a(b)+`</span>.</span>
<span id="cb87-331"><a href="#cb87-331"></a>    </span>
<span id="cb87-332"><a href="#cb87-332"></a></span>
<span id="cb87-333"><a href="#cb87-333"></a>    </span>
<span id="cb87-334"><a href="#cb87-334"></a>**Exercise:** Using the <span class="in">`words`</span> data, find (1) words that start with "y" and (2) words that don't start with "y".</span>
<span id="cb87-335"><a href="#cb87-335"></a></span>
<span id="cb87-336"><a href="#cb87-336"></a><span class="in">```{r ex_regex_start_end_group}</span></span>
<span id="cb87-337"><a href="#cb87-337"></a><span class="in"># Your code</span></span>
<span id="cb87-338"><a href="#cb87-338"></a><span class="in"># Match words that have vowel-x-vowel</span></span>
<span id="cb87-339"><a href="#cb87-339"></a><span class="in">str_view(words, "^y")</span></span>
<span id="cb87-340"><a href="#cb87-340"></a></span>
<span id="cb87-341"><a href="#cb87-341"></a><span class="in"># Match words that have not_vowel-y-not_vowel</span></span>
<span id="cb87-342"><a href="#cb87-342"></a><span class="in">str_view(words, "[^y]")</span></span>
<span id="cb87-343"><a href="#cb87-343"></a></span>
<span id="cb87-344"><a href="#cb87-344"></a></span>
<span id="cb87-345"><a href="#cb87-345"></a><span class="in">```</span></span>
<span id="cb87-346"><a href="#cb87-346"></a></span>
<span id="cb87-347"><a href="#cb87-347"></a></span>
<span id="cb87-348"><a href="#cb87-348"></a></span>
<span id="cb87-349"><a href="#cb87-349"></a><span class="fu">## Exploring `stringr` functions  </span></span>
<span id="cb87-350"><a href="#cb87-350"></a></span>
<span id="cb87-351"><a href="#cb87-351"></a>Read in the "Dear Abby" data underlying The Pudding's <span class="co">[</span><span class="ot">30 Years of American Anxieties</span><span class="co">](https://pudding.cool/2018/11/dearabby/)</span> article.</span>
<span id="cb87-352"><a href="#cb87-352"></a></span>
<span id="cb87-353"><a href="#cb87-353"></a><span class="in">```{r read_dear_abby}</span></span>
<span id="cb87-354"><a href="#cb87-354"></a><span class="in">posts &lt;- read_csv("https://raw.githubusercontent.com/the-pudding/data/master/dearabby/raw_da_qs.csv")</span></span>
<span id="cb87-355"><a href="#cb87-355"></a><span class="in">```</span></span>
<span id="cb87-356"><a href="#cb87-356"></a></span>
<span id="cb87-357"><a href="#cb87-357"></a>Take a couple minutes to scroll through the <span class="co">[</span><span class="ot">30 Years of American Anxieties</span><span class="co">](https://pudding.cool/2018/11/dearabby/)</span> article to get ideas for themes that you might want to search for using regular expressions.</span>
<span id="cb87-358"><a href="#cb87-358"></a></span>
<span id="cb87-359"><a href="#cb87-359"></a>&lt;br&gt;</span>
<span id="cb87-360"><a href="#cb87-360"></a></span>
<span id="cb87-361"><a href="#cb87-361"></a>The following are core <span class="in">`stringr`</span> functions that use regular expressions:</span>
<span id="cb87-362"><a href="#cb87-362"></a></span>
<span id="cb87-363"><a href="#cb87-363"></a><span class="ss">- </span><span class="in">`str_view()`</span> - View the first occurrence in a string that matches the regex</span>
<span id="cb87-364"><a href="#cb87-364"></a><span class="ss">- </span><span class="in">`str_count()`</span> - Count the number of times a regex matches within a string</span>
<span id="cb87-365"><a href="#cb87-365"></a><span class="ss">- </span><span class="in">`str_detect()`</span> - Determine if (TRUE/FALSE) the regex is found within string</span>
<span id="cb87-366"><a href="#cb87-366"></a><span class="ss">- </span><span class="in">`str_subset()`</span> - Return subset of strings that match the regex</span>
<span id="cb87-367"><a href="#cb87-367"></a><span class="ss">- </span><span class="in">`str_extract(), str_extract_all()`</span> - Return portion of each string that matches the regex. <span class="in">`str_extract()`</span> extracts the first instance of the match. <span class="in">`str_extract_all()`</span> extracts all matches.</span>
<span id="cb87-368"><a href="#cb87-368"></a><span class="ss">- </span><span class="in">`str_replace(), str_replace_all()`</span> - Replace portion of string that matches the regex with something else. <span class="in">`str_replace()`</span> replaces the first instance of the match. <span class="in">`str_replace_all()`</span> replaces all instances of the match.</span>
<span id="cb87-369"><a href="#cb87-369"></a><span class="ss">- </span><span class="in">`str_remove(), str_remove_all()`</span> - Removes the portion of the string that matches the pattern. Equivalent to <span class="in">`str_replace(x, "THE REGEX PATTERN", "")`</span></span>
<span id="cb87-370"><a href="#cb87-370"></a></span>
<span id="cb87-371"><a href="#cb87-371"></a>**Exercise:** Starting from <span class="in">`str_count()`</span>, explore each of these functions by pulling up the function documentation page and reading through the arguments. Try out each function using the <span class="in">`posts`</span> data.</span>
<span id="cb87-372"><a href="#cb87-372"></a></span>
<span id="cb87-375"><a href="#cb87-375"></a><span class="in">```{r}</span></span>
<span id="cb87-376"><a href="#cb87-376"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb87-377"><a href="#cb87-377"></a>    <span class="at">word_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb87-378"><a href="#cb87-378"></a>    <span class="at">word =</span> <span class="fu">c</span>(<span class="st">"replace"</span>, <span class="st">"match"</span>, <span class="st">"pattern"</span>)</span>
<span id="cb87-379"><a href="#cb87-379"></a>)</span>
<span id="cb87-380"><a href="#cb87-380"></a></span>
<span id="cb87-381"><a href="#cb87-381"></a>df <span class="sc">|&gt;</span></span>
<span id="cb87-382"><a href="#cb87-382"></a>    <span class="fu">mutate</span>(</span>
<span id="cb87-383"><a href="#cb87-383"></a>        <span class="at">word_length =</span> <span class="fu">str_length</span>(word),</span>
<span id="cb87-384"><a href="#cb87-384"></a>        <span class="at">middle_pos =</span> <span class="fu">ceiling</span>(word_length<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb87-385"><a href="#cb87-385"></a>        <span class="at">middle_letter =</span> <span class="fu">str_sub</span>(word, middle_pos, middle_pos)</span>
<span id="cb87-386"><a href="#cb87-386"></a>    )</span>
<span id="cb87-387"><a href="#cb87-387"></a><span class="in">```</span></span>
<span id="cb87-388"><a href="#cb87-388"></a>**Exercise:** Using the <span class="in">`words`</span> data, find (1) words that start with "y" and (2) words that don't start with "y".</span>
<span id="cb87-389"><a href="#cb87-389"></a></span>
<span id="cb87-390"><a href="#cb87-390"></a><span class="in">```{r ex_regex_start_end_group2}</span></span>
<span id="cb87-391"><a href="#cb87-391"></a><span class="in"># This regex finds "a" then "b" at most once (can't have 2 or more b's in a row)</span></span>
<span id="cb87-392"><a href="#cb87-392"></a><span class="in">str_view(c("a", "ab", "abb"), "ab?")</span></span>
<span id="cb87-393"><a href="#cb87-393"></a></span>
<span id="cb87-394"><a href="#cb87-394"></a><span class="in"># There has to be an "a" followed by at least one b</span></span>
<span id="cb87-395"><a href="#cb87-395"></a><span class="in"># This is why the first string "a" isn't matched</span></span>
<span id="cb87-396"><a href="#cb87-396"></a><span class="in">str_view(c("a", "ab", "abb"), "ab+")</span></span>
<span id="cb87-397"><a href="#cb87-397"></a><span class="in"># There must be an "a" and then any number of b's (including zero)</span></span>
<span id="cb87-398"><a href="#cb87-398"></a><span class="in">str_view(c("a", "ab", "abb"), "ab*")</span></span>
<span id="cb87-399"><a href="#cb87-399"></a><span class="in">str_view(words, "[aeiou][aeiou]m")</span></span>
<span id="cb87-400"><a href="#cb87-400"></a><span class="in">str_view(fruit, "aa|ee|ii|oo|uu")</span></span>
<span id="cb87-401"><a href="#cb87-401"></a><span class="in"># Words that start with y</span></span>
<span id="cb87-402"><a href="#cb87-402"></a><span class="in">str_view(words, "^y")</span></span>
<span id="cb87-403"><a href="#cb87-403"></a></span>
<span id="cb87-404"><a href="#cb87-404"></a><span class="in"># Words that don't start with y</span></span>
<span id="cb87-405"><a href="#cb87-405"></a><span class="in">str_view(words, "^[^y]")</span></span>
<span id="cb87-406"><a href="#cb87-406"></a><span class="in">```</span></span>
<span id="cb87-407"><a href="#cb87-407"></a></span>
<span id="cb87-408"><a href="#cb87-408"></a><span class="fu">## Done!</span></span>
<span id="cb87-409"><a href="#cb87-409"></a></span>
<span id="cb87-410"><a href="#cb87-410"></a><span class="ss">- </span>Check the ICA Instructions for how to (a) push your code to GitHub and (b) update your portfolio website</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>